@tailwind base;
@tailwind components;
@tailwind utilities;

/* Mobile safe area helpers & global chrome */
@layer base {
  :root {
    color-scheme: dark;
    --app-bg: #020617;
    --app-surface: #0f172a;
    --app-accent: #22d3ee;
    --app-accent-rgb: 34, 211, 238;
    /* for opacity magic */
  }

  :root[data-theme="matrix"] {
    --app-bg: #000000;
    --app-surface: #111111;
    --app-accent: #22c55e;
    --app-accent-rgb: 34, 197, 94;
  }

  :root[data-theme="vaporwave"] {
    --app-bg: #2e022d;
    --app-surface: #4a044a;
    --app-accent: #f472b6;
    --app-accent-rgb: 244, 114, 182;
  }

  html,
  body,
  #root {
    height: 100%;
  }

  body {
    background-color: var(--app-bg);
    color: #f8fafc;
    transition: background-color 0.5s ease, color 0.5s ease;
  }

  /* Improve Leaflet panning on touch and prevent weird selection/dragging */
  .leaflet-container {
    touch-action: pan-x pan-y;
    -ms-touch-action: pan-x pan-y;
    user-select: none;
    -webkit-user-select: none;
    background: var(--app-bg) !important;
    /* Match map background to theme */
  }

  /* Map Tile Filtering for Themes */
  :root[data-theme="cyberpunk"] .leaflet-tile-pane {
    filter: invert(100%) hue-rotate(180deg) brightness(0.7) contrast(1.2) grayscale(0.2);
  }

  :root[data-theme="matrix"] .leaflet-tile-pane {
    filter: invert(100%) sepia(100%) hue-rotate(90deg) brightness(0.8) contrast(1.5);
  }

  :root[data-theme="vaporwave"] .leaflet-tile-pane {
    filter: invert(100%) sepia(60%) hue-rotate(190deg) brightness(0.9) contrast(1.1);
  }
}

@layer components {
  .safe-pb {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .app-shell {
    @apply flex h-full w-full flex-col bg-gradient-to-b from-black via-slate-950 to-slate-950;
  }

  .app-header {
    @apply flex items-center justify-between px-4 py-3 text-sm font-medium text-slate-300/90;
  }

  .app-logo {
    @apply text-base font-semibold tracking-tight text-slate-50;
  }

  .glass-panel {
    @apply rounded-2xl border border-slate-800/80 bg-slate-950/80 shadow-glow backdrop-blur;
  }

  .primary-btn {
    @apply inline-flex items-center justify-center gap-2 rounded-xl bg-app-accentSoft px-4 py-2 text-sm font-semibold text-cyan-100 ring-1 ring-app-accent/40 transition-colors hover:bg-app-accent/25 hover:text-cyan-50 active:bg-app-accent/30;
  }

  .primary-btn--danger {
    @apply bg-rose-500/15 text-rose-100 ring-rose-500/40 hover:bg-rose-500/25 hover:text-rose-50;
  }

  .icon-btn {
    @apply inline-flex h-9 w-9 items-center justify-center rounded-xl bg-slate-900/80 text-slate-300 ring-1 ring-slate-800 transition-colors hover:bg-slate-800 hover:text-slate-50 active:bg-slate-700;
  }

  .icon-btn--active {
    @apply bg-app-accentSoft text-cyan-100 ring-app-accent/40 hover:bg-app-accent/25;
  }

  .stat-card {
    @apply flex min-w-0 flex-col;
  }

  .stat-card-label {
    @apply text-xs font-medium text-slate-400;
  }

  .stat-card-value {
    @apply truncate text-lg font-semibold tracking-tight text-slate-50;
  }

  .bottom-bar {
    @apply pointer-events-auto mx-auto flex w-full max-w-md items-center justify-between gap-2 rounded-2xl border border-slate-800 bg-slate-950/80 p-2 shadow-glow backdrop-blur;
  }
}